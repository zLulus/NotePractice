源代码来自[用WPF实现打印及打印预览](https://www.cnblogs.com/guogangj/archive/2013/02/27/2934733.html)